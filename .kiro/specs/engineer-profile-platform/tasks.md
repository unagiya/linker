# 実装計画

- [x] 1. Supabaseプロジェクトのセットアップ
  - Supabaseプロジェクトの作成（https://supabase.com）
  - プロジェクトURLとAPIキーの取得
  - 環境変数の設定（.env.local）
  - @supabase/supabase-jsのインストール
  - Supabaseクライアントの初期化（src/lib/supabase.ts）
  - _要件: すべての要件の基盤_

- [x] 2. データベーススキーマの作成
  - profilesテーブルの作成（SQL実行）
  - Row Level Security (RLS)の有効化
  - RLSポリシーの作成（SELECT, INSERT, UPDATE, DELETE）
  - updated_at自動更新トリガーの作成
  - _要件: 7.1, 11.5_

- [x] 3. 型定義とバリデーションスキーマの更新
  - User型の定義（Supabase Auth用）
  - Profile型の更新（user_idフィールドを追加）
  - 認証用のZodスキーマの実装（signUpSchema, signInSchema）
  - プロフィール用のZodスキーマの更新
  - _要件: 1.3, 1.4, 4.5, 4.7_

- [x] 3.1 バリデーション関数のユニットテストを作成
  - メールアドレスバリデーションのテスト
  - パスワードバリデーションのテスト
  - URLバリデーションのテスト
  - 数値バリデーションのテスト
  - _要件: 1.3, 1.4, 4.5, 4.7_

- [x] 3.2 プロパティ2のプロパティベーステストを実装
  - **プロパティ2: 無効なメールアドレスの拒否**
  - **検証: 要件 1.3**

- [x] 3.3 プロパティ3のプロパティベーステストを実装
  - **プロパティ3: 短いパスワードの拒否**
  - **検証: 要件 1.4**

- [x] 3.4 プロパティ16のプロパティベーステストを実装
  - **プロパティ16: URLバリデーション**
  - **検証: 要件 4.5**

- [x] 3.5 プロパティ18のプロパティベーステストを実装
  - **プロパティ18: 経験年数の数値バリデーション**
  - **検証: 要件 4.7**

- [x] 4. 認証サービスの実装
  - authService.tsの作成
  - signUp関数の実装
  - signIn関数の実装
  - signOut関数の実装
  - getSession関数の実装
  - getCurrentUser関数の実装
  - _要件: 1.2, 2.2, 2.5_

- [x] 4.1 authServiceのユニットテストを作成
  - モックSupabaseクライアントを使用したテスト
  - 各関数のテスト
  - エラーハンドリングのテスト
  - _要件: 1.2, 2.2, 2.5_

- [x] 4.2 プロパティ1のプロパティベーステストを実装
  - **プロパティ1: 有効な認証情報でのアカウント作成**
  - **検証: 要件 1.2**

- [x] 4.3 プロパティ5のプロパティベーステストを実装
  - **プロパティ5: 正しい認証情報でのログイン**
  - **検証: 要件 2.2**

- [x] 4.4 プロパティ6のプロパティベーステストを実装
  - **プロパティ6: 間違った認証情報の拒否**
  - **検証: 要件 2.3**

- [x] 5. AuthContextの実装
  - AuthContextとAuthProviderの作成
  - useReducerを使用した状態管理
  - signUp, signIn, signOutアクションの実装
  - セッション監視の実装（onAuthStateChange）
  - ローディング状態とエラー状態の管理
  - _要件: 1.2, 2.2, 2.5, 2.6_

- [x] 5.1 AuthContextのユニットテストを作成
  - モックauthServiceを使用したテスト
  - 各アクションのテスト
  - セッション監視のテスト
  - _要件: 1.2, 2.2, 2.5, 2.6_

- [x] 5.2 プロパティ9のプロパティベーステストを実装
  - **プロパティ9: セッションの永続性**
  - **検証: 要件 2.6**

- [x] 6. Repository層の実装
  - ProfileRepositoryインターフェースの定義
  - SupabaseProfileRepositoryの実装（save, findById, findByUserId, findAll, delete, exists）
  - データマッピング関数の実装（Supabase ↔ アプリケーション型）
  - エラーハンドリングの実装
  - _要件: 7.1, 7.2_

- [x] 6.1 SupabaseProfileRepositoryのユニットテストを作成
  - モックSupabaseクライアントを使用したテスト
  - 各メソッドのテスト
  - エラーケースのテスト
  - _要件: 7.1, 7.2_

- [x] 6.2 プロパティ27のプロパティベーステストを実装
  - **プロパティ27: データベースラウンドトリップ**
  - **検証: 要件 7.1, 7.2**

- [x] 7. ProfileContextの実装
  - ProfileContextとProfileProviderの作成
  - useReducerを使用した状態管理
  - Repository依存性注入の実装
  - createProfile, updateProfile, deleteProfile, loadProfile, loadMyProfileアクションの実装
  - ローディング状態とエラー状態の管理
  - _要件: 3.3, 5.4, 10.2_

- [x] 7.1 ProfileContextのユニットテストを作成
  - モックRepositoryを使用したテスト
  - 各アクションのテスト
  - エラーハンドリングのテスト
  - _要件: 3.3, 5.4, 10.2_

- [x] 8. 共通UIコンポーネントの実装
  - Buttonコンポーネント
  - Inputコンポーネント
  - TextAreaコンポーネント
  - LoadingSpinnerコンポーネント
  - ErrorMessageコンポーネント
  - _要件: 9.2, 9.4_

- [x] 9. AuthFormコンポーネントの実装
  - フォームレイアウトの作成
  - メールアドレスとパスワードの入力フィールド
  - モード切り替え（登録/ログイン）
  - リアルタイムバリデーションの実装
  - エラーメッセージ表示の実装
  - _要件: 1.1, 2.1_

- [x] 9.1 AuthFormコンポーネントのユニットテストを作成
  - フォーム送信のテスト
  - バリデーションエラー表示のテスト
  - モード切り替えのテスト
  - _要件: 1.1, 2.1_

- [x] 10. アカウント登録ページの実装
  - SignUpページコンポーネントの作成
  - AuthFormの統合（signupモード）
  - アカウント登録処理の実装
  - 登録成功時の自動ログインとリダイレクト処理
  - _要件: 1.1, 1.2, 1.5_

- [x] 10.1 プロパティ4のプロパティベーステストを実装
  - **プロパティ4: アカウント作成後の自動ログインとリダイレクト**
  - **検証: 要件 1.5**

- [x] 11. ログインページの実装
  - SignInページコンポーネントの作成
  - AuthFormの統合（signinモード）
  - ログイン処理の実装
  - ログイン成功時のリダイレクト処理
  - _要件: 2.1, 2.2, 2.4_

- [x] 11.1 プロパティ7のプロパティベーステストを実装
  - **プロパティ7: ログイン成功後のリダイレクト**
  - **検証: 要件 2.4**

- [x] 12. ProtectedRouteコンポーネントの実装
  - 認証状態のチェック
  - 未認証ユーザーのリダイレクト処理
  - ローディング状態の表示
  - _要件: 3.1, 5.2_

- [x] 12.1 プロパティ10のプロパティベーステストを実装
  - **プロパティ10: 未認証ユーザーの保護されたページへのアクセス拒否**
  - **検証: 要件 3.1**

- [x] 13. ProfileFormコンポーネントの実装
  - フォームレイアウトの作成
  - 基本フィールド（名前、職種、自己紹介、経験年数）の実装
  - スキルタグ入力の実装
  - SNSリンク動的追加・削除機能の実装
  - サービス選択UI（定義済み/カスタム）の実装
  - リアルタイムバリデーションの実装
  - エラーメッセージ表示の実装
  - _要件: 3.2, 4.1, 4.2, 4.3, 4.4, 4.6, 4.8, 9.2_

- [x] 13.1 ProfileFormコンポーネントのユニットテストを作成
  - フォーム送信のテスト
  - バリデーションエラー表示のテスト
  - スキル追加・削除のテスト
  - SNSリンク追加・削除のテスト
  - _要件: 3.2, 4.1, 4.6, 4.8_

- [x] 13.2 プロパティ14のプロパティベーステストを実装
  - **プロパティ14: 無効な必須項目の拒否**
  - **検証: 要件 3.5**

- [x] 13.3 プロパティ17のプロパティベーステストを実装
  - **プロパティ17: スキル配列の管理**
  - **検証: 要件 4.6**

- [x] 14. プロフィール作成ページの実装
  - CreateProfileページコンポーネントの作成
  - ProtectedRouteでラップ
  - ProfileFormの統合
  - プロフィール作成処理の実装（user_idの紐付け）
  - 作成成功時のリダイレクト処理
  - _要件: 3.1, 3.2, 3.3, 3.4, 3.6_

- [x] 14.1 プロパティ11のプロパティベーステストを実装
  - **プロパティ11: 認証済みユーザーのプロフィール作成ページへのアクセス**
  - **検証: 要件 3.2**

- [x] 14.2 プロパティ12のプロパティベーステストを実装
  - **プロパティ12: 有効なプロフィールデータの保存**
  - **検証: 要件 3.3**

- [x] 14.3 プロパティ13のプロパティベーステストを実装
  - **プロパティ13: プロフィールと所有者の紐付け**
  - **検証: 要件 3.4, 11.1**

- [x] 14.4 プロパティ15のプロパティベーステストを実装
  - **プロパティ15: プロフィール作成後のリダイレクト**
  - **検証: 要件 3.6**

- [x] 15. ProfileCardコンポーネントの実装
  - 名刺風レイアウトの作成
  - プロフィール情報の表示
  - SNSリンクの表示（アイコン付き）
  - 所有者判定による編集・削除ボタンの表示制御
  - 共有ボタンの実装
  - レスポンシブデザインの実装
  - _要件: 6.2, 11.2, 11.3, 11.4_

- [x] 15.1 ProfileCardコンポーネントのユニットテストを作成
  - プロフィール情報表示のテスト
  - SNSリンク表示のテスト
  - ボタン表示制御のテスト（所有者判定）
  - _要件: 6.2, 11.2, 11.3, 11.4_

- [x] 15.2 プロパティ26のプロパティベーステストを実装
  - **プロパティ26: プロフィール情報の完全表示**
  - **検証: 要件 6.2**

- [x] 15.3 プロパティ35のプロパティベーステストを実装
  - **プロパティ35: 未認証ユーザーへの編集・削除ボタン非表示**
  - **検証: 要件 11.2**

- [x] 15.4 プロパティ36のプロパティベーステストを実装
  - **プロパティ36: 他人のプロフィールへの編集・削除ボタン非表示**
  - **検証: 要件 11.3**

- [x] 15.5 プロパティ37のプロパティベーステストを実装
  - **プロパティ37: 自分のプロフィールへの編集・削除ボタン表示**
  - **検証: 要件 11.4**

- [ ] 16. プロフィール表示ページの実装
  - ViewProfileページコンポーネントの作成
  - URLパラメータからプロフィールIDを取得
  - プロフィールデータの読み込み
  - ProfileCardの統合
  - 所有者判定ロジックの実装
  - 404エラーハンドリング（プロフィールが存在しない場合）
  - _要件: 6.1, 11.2, 11.3, 11.4_

- [ ] 16.1 プロパティ25のプロパティベーステストを実装
  - **プロパティ25: プロフィールURLアクセス**
  - **検証: 要件 6.1**

- [ ] 17. プロフィール編集ページの実装
  - EditProfileページコンポーネントの作成
  - ProtectedRouteでラップ
  - 所有者チェックの実装
  - 既存プロフィールデータの読み込み
  - ProfileFormへの初期値設定
  - 更新処理の実装
  - キャンセル処理の実装
  - 更新成功時のリダイレクト処理
  - _要件: 5.1, 5.2, 5.3, 5.4, 5.5, 5.6_

- [ ] 17.1 プロパティ19のプロパティベーステストを実装
  - **プロパティ19: 編集フォームへのデータ読み込み**
  - **検証: 要件 5.1**

- [ ] 17.2 プロパティ20のプロパティベーステストを実装
  - **プロパティ20: 未認証ユーザーの編集ページへのアクセス拒否**
  - **検証: 要件 5.2**

- [ ] 17.3 プロパティ21のプロパティベーステストを実装
  - **プロパティ21: 他人のプロフィール編集の拒否**
  - **検証: 要件 5.3**

- [ ] 17.4 プロパティ22のプロパティベーステストを実装
  - **プロパティ22: プロフィール更新の永続化**
  - **検証: 要件 5.4**

- [ ] 17.5 プロパティ23のプロパティベーステストを実装
  - **プロパティ23: 更新後のデータ表示**
  - **検証: 要件 5.5**

- [ ] 17.6 プロパティ24のプロパティベーステストを実装
  - **プロパティ24: 編集キャンセルの不変性**
  - **検証: 要件 5.6**

- [ ] 18. プロフィール削除機能の実装
  - 削除確認ダイアログコンポーネントの作成
  - 削除処理の実装
  - 削除成功時のリダイレクト処理
  - キャンセル処理の実装
  - _要件: 10.1, 10.2, 10.3, 10.4_

- [ ] 18.1 プロパティ31のプロパティベーステストを実装
  - **プロパティ31: プロフィール削除確認ダイアログの表示**
  - **検証: 要件 10.1**

- [ ] 18.2 プロパティ32のプロパティベーステストを実装
  - **プロパティ32: プロフィール削除の永続化**
  - **検証: 要件 10.2**

- [ ] 18.3 プロパティ33のプロパティベーステストを実装
  - **プロパティ33: 削除後のリダイレクト**
  - **検証: 要件 10.3**

- [ ] 18.4 プロパティ34のプロパティベーステストを実装
  - **プロパティ34: 削除キャンセルの不変性**
  - **検証: 要件 10.4**

- [ ] 19. URL共有機能の実装
  - 共有URL生成ロジックの実装
  - クリップボードAPIの統合
  - コピー成功通知の実装
  - _要件: 8.1, 8.4_

- [ ] 19.1 プロパティ28のプロパティベーステストを実装
  - **プロパティ28: クリップボードへのURLコピー**
  - **検証: 要件 8.4**

- [ ] 20. ナビゲーションとルーティングの実装
  - Navigationコンポーネントの作成
  - ログイン状態に応じた表示切り替え（ログイン/ログアウトボタン）
  - React Routerの設定
  - ルート定義（/, /signup, /signin, /create, /profile/:id, /profile/:id/edit）
  - 404ページの実装
  - _要件: 9.3_

- [ ] 20.1 プロパティ8のプロパティベーステストを実装
  - **プロパティ8: ログアウト後のセッション終了**
  - **検証: 要件 2.5**

- [ ] 21. ホームページの実装
  - ホームページコンポーネントの作成
  - ログイン状態に応じた表示切り替え
  - ログイン済み：プロフィール作成へのリンク
  - 未ログイン：登録/ログインへのリンク
  - 簡単な説明文の表示
  - _要件: 1.1, 2.1_

- [ ] 22. ローディング状態とエラーハンドリングの実装
  - ローディングインジケーターの統合
  - エラーメッセージ表示の統合
  - グローバルエラーバウンダリの実装
  - 認証エラーのハンドリング
  - データベースエラーのハンドリング
  - _要件: 9.2, 9.4_

- [ ] 22.1 プロパティ29のプロパティベーステストを実装
  - **プロパティ29: バリデーションエラーメッセージ表示**
  - **検証: 要件 9.2**

- [ ] 22.2 プロパティ30のプロパティベーステストを実装
  - **プロパティ30: ローディング状態の表示**
  - **検証: 要件 9.4**

- [ ] 23. スタイリングとレスポンシブデザインの実装
  - CSS ModulesまたはTailwind CSSのセットアップ
  - 各コンポーネントのスタイリング
  - レスポンシブデザインの実装（モバイル・タブレット・デスクトップ）
  - 名刺風デザインの洗練
  - 定義済みサービスのアイコン追加
  - _要件: 9.1_

- [ ] 24. チェックポイント - すべてのテストが通ることを確認
  - すべてのテストが通ることを確認し、問題があればユーザーに質問する

- [ ] 25. 統合テストの作成
  - アカウント登録からプロフィール作成までのフロー
  - ログインからプロフィール編集までのフロー
  - プロフィール削除フローの統合テスト
  - 認証ガードのテスト（未認証ユーザーのアクセス制御）
  - 所有者制御のテスト（他人のプロフィール編集の拒否）
  - Row Level Security (RLS)のテスト
  - ルーティングとナビゲーションのテスト

- [ ] 26. 最終調整とリファクタリング
  - コードレビューと最適化
  - 不要なコードの削除
  - コメントとドキュメントの追加
  - パフォーマンスの確認
  - Supabase設定の最終確認
  - _要件: すべて_

- [ ] 27. 最終チェックポイント - すべてのテストが通ることを確認
  - すべてのテストが通ることを確認し、問題があればユーザーに質問する
